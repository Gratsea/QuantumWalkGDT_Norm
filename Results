Example 1

n=5 , sites k=6

Results

1. test3

initial = 

initial[0][0]= 1.
initial[1][0]= 1.5
initial/= np.linalg.norm(initial)

Phi[[-2.53787400e-04+0.00073287j]
 [ 0.00000000e+00+0.        j]
 [-1.99820395e-01-0.00035552j]
 [ 1.64592281e-04-0.0004793 j]
 [ 5.17225379e-01+0.00016506j]
 [ 1.30808461e-01-0.00078185j]
 [ 4.39979507e-01+0.00046699j]
 [-1.50021463e-01+0.00057014j]
 [-2.02253620e-03-0.00014818j]
 [ 6.77741808e-01-0.00076727j]
 [ 0.00000000e+00+0.        j]
 [-3.09588175e-03-0.00021878j]]
Phi_internal_reshaped[[-1.99820395e-01  5.17225379e-01  4.39979507e-01 -2.02253620e-03]
 [ 1.64592281e-04  1.30808461e-01 -1.50021463e-01  6.77741808e-01]]
NORM1.4142039948878378
l[ 0.70710699  0.70710657]

==> Phi_internal_reshaped ()
[ [-0.20  0.52  0.44  0.00 ]
  [ 0.00  0.13 -0.15  0.68 ] ]
  
  coin parameters (5 coins) --correct as well
z = [ 5.67245656e-01  8.62542665e-01  3.24500715e+00  
      1.14230303e-04   1.67421087e+00  2.14350919e+00  
      1.81753069e-01  6.85589784e+00   -1.18406431e-01  
      7.03375383e-01  9.30637140e+00  8.47415396e-01
      7.00791378e-01  2.15641254e+00  9.99177735e-01] 
      
 listc =
 [array([[ 0.75315713+0.j        , -0.59745042+0.27533132j],
        [-0.47240240-0.45781035j, -0.71057385-0.2496607j ]]),
 array([[ 0.01068786+0.j        ,  0.52035344-0.85388411j],
        [ 0.90002677+0.43570354j, -0.00898281+0.00579133j]]),
 array([[ 0.42632507+0.j        , -0.81344809+0.39566291j],
        [ 0.84270448-0.3287797j ,  0.28938133-0.31306791j]]),
 array([[ 0.83867478+0.j        , -0.31124390-0.44693607j],
        [-0.48324750+0.2511901j , -0.74268230-0.38961312j]]),
 array([[ 0.83713283+0.j        ,  0.48227889+0.25810015j],
        [-0.54699783+0.00141302j,  0.73910155+0.39309068j]])]
      
      
#delete outer sites :
  coin parameters
array([  5.68522976e-01,   8.65712906e-01,   3.24550472e+00,      
        -2.51271256e-08,   1.67470846e+00,   2.14480399e+00,
         1.77182025e-01,   6.85719332e+00,  -1.19194522e-01,
         7.04930793e-01,   9.30558346e+00,   8.45526613e-01,
         7.09160290e-01,   2.15452369e+00,   9.99999630e-01])
  
  coin-operators
[array([[ 0.75400463+0.j        , -0.59927656+0.26896957j],
        [-0.47098956-0.45787101j, -0.70844625-0.25812185j]]),
 array([[  1.58515380e-04 +0.00000000e+00j,
           5.21717414e-01 -8.53118348e-01j],
        [  8.98298308e-01 +4.39386078e-01j,
          -1.33708708e-04 +8.51416878e-05j]]),
 array([[ 0.42092995+0.j        , -0.81732507+0.3934434j ],
        [ 0.84423616-0.331788j  ,  0.28621158-0.30865022j]])] 
        
 result from forward quantum walk with given coins : 
 array([[ -3.79213681e-06 +1.05579453e-05j],
       [  0.00000000e+00 +0.00000000e+00j],
       [ -1.98642075e-01 -4.44084964e-06j],
       [  2.42849514e-06 -6.76136273e-06j],
       [  5.21248004e-01 -4.33148440e-07j],
       [  1.27214819e-01 -6.93554472e-06j],
       [  4.34559705e-01 -1.77964580e-06j],
       [ -1.52545636e-01 +2.65038090e-07j],
       [ -2.92659117e-05 -2.15998360e-06j],
       [  6.78635339e-01 +1.22684700e-06j],
       [  0.00000000e+00 +0.00000000e+00j],
       [ -4.56990790e-05 -3.37278740e-06j]])
        
  
clarification : max.ent.state over sites {2,5} not sites {3,4} :

Phi_internal_internal =
array([[ 0.51992254,  0.43594997],
       [ 0.12784624, -0.15196018]])
       
lli = array([0.67850714, 0.1985861 ]) --> not maximally entnagled state.

code : 
Phi_internal_internal = np.delete(Phi_internal_reshaped,[0,3,4,7],None)
Phi_internal_internal= Phi_internal_internal.reshape(2,2)
psiAAi, lli, psiBBi = np.linalg.svd(Phi_internal_internal,full_matrices=1) #decomposition of initial matrix
print (lli)


1.2 

same initial state
#over sites m={2,3,4,6} Phi - outersites are zero
Phi_internal_reshaped[[ -2.33266569e-05  -7.07110050e-01   5.88722608e-05   0.00000000e+00]
 [ -2.67870661e-05  -6.74529580e-05  -7.07103503e-01   2.21672419e-06]]
 
 we arrive at a Bell state over m=3,m=4 : 
 [ 0, 0,-0.707, 0.0  ,0,0]
 [ 0, 0,  0.0 , 0.707,0,0]
 
 ret.x = [ 5.31833144e-01,   5.64759220e-01,   3.47305045e+00,
        -1.13690253e-08,   1.33153933e+00,   1.43735648e+00,
        -3.04895434e-01,   6.13596808e+00,   7.80891270e-01,
         3.50205547e-08,   9.78234633e+00,   9.80884794e-01,
         1.08887806e+00,   1.73091168e+00,   7.08247138e-01]
 
 
 listc = [array([[ 0.72926891+0.j        , -0.13824572+0.67011564j],
        [-0.05786058-0.68177636j, -0.72413022-0.08642089j]]),
 array([[  1.06625632e-04 +0.00000000e+00j,
          -5.04872973e-01 -8.63193645e-01j],
        [ -1.95532519e-01 -9.80697213e-01j,
           7.97359829e-05 -7.07898180e-05j]]),
 array([[ 0.55217337+0.j        ,  0.75881667+0.34540098j],
        [-0.64388499+0.52963826j,  0.53344493-0.1425901j ]]),
 array([[  1.87137796e-04 +0.00000000e+00j,
           7.75190842e-01 -6.31727096e-01j],
        [ -9.98197392e-01 +6.00161022e-02j,
           1.37710906e-04 -1.26713303e-04j]]),
 array([[ 0.32998152+0.j        ,  0.62629557-0.7063045j ],
        [-0.57446029+0.74907114j, -0.06268873-0.32397211j]])]
 
 
 
 ---> Bell state psi+
l[ 0.70711218  0.70710138]
NORM1.414213559977338
z[  2.98601523e-01   9.72545140e-02   3.31875824e+00   2.30787070e-01
   1.74796221e+00   1.71505841e+00  -2.58219001e-08   6.42744740e+00
  -1.41122592e-01   2.30806585e-01   9.28365549e+00   7.28923355e-01
   3.85413788e-01   2.03792029e+00   1.05146159e+00]
 [ 0, 0,-0.707, 0.0  ,0,0]
 [ 0, 0,  0.0 , -0.707,0,0]
 
 listc = 
 [array([[ 0.54644444+0.j        ,  0.79870797+0.25192074j],
        [-0.45150758-0.70536471j,  0.14251425+0.52753314j]]),
 array([[ 0.48040303+0.j        ,  0.61618355-0.62412399j],
        [ 0.54849332-0.68437417j,  0.05568496+0.47716481j]]),
 array([[  1.60691942e-04 +0.00000000e+00j,
           2.25962241e-01 +9.74136048e-01j],
        [  9.03319810e-01 -4.28967709e-01j,
          -9.99486351e-05 -1.25825953e-04j]]),
 array([[ 0.48042334+0.j        , -0.55124699-0.68214381j],
        [-0.57776630+0.65983295j, -0.48004826-0.01898024j]]),
 array([[ 0.62081703+0.j        ,  0.77839913+0.09317195j],
        [-0.77373242-0.12619174j,  0.59650189+0.17204442j]])]
        
        
    1.3
    
    
   same initial state and choose m=2,3 and arrive at a Bell state. --  NORM_site25_n3_T1 (all the above T1 and n=1 or 3)

Phi[[  1.27947963e-04 +4.18684774e-05j]
 [  0.00000000e+00 +0.00000000e+00j]
 [ -7.07108365e-01 +5.31823734e-05j]
 [ -3.59545239e-09 +1.32079013e-08j]
 [ -1.11838556e-04 +1.23746771e-05j]
 [ -4.24550680e-05 -3.92263132e-05j]
 [ -4.24874018e-05 +3.92660021e-05j]
 [  1.44054959e-04 +7.15024687e-05j]
 [ -3.61223558e-09 -1.32066621e-08j]
 [  7.07105130e-01 -1.05153476e-04j]
 [  0.00000000e+00 +0.00000000e+00j]
 [ -1.27927464e-04 +4.20327119e-05j]]
Phi_internal_reshaped[[ -7.07108365e-01  -3.61223558e-09]
 [ -3.59545239e-09   7.07105130e-01]]
l[ 0.70710836  0.70710513]
NORM1.414213494943214
z[ -8.99414362e-01   3.13528396e-01   3.63809028e+00  -1.24152275e+00
   2.40549780e+00   2.35834967e+00   3.33416369e-07   6.54081009e+00
   7.35390903e-01   8.75863291e-01   1.01637288e+01   8.96726997e-01
   9.99999990e-01   2.29642948e+00   2.48393543e+00]
   
   listc = [array([[ 0.94858634+0.j        ,  0.17504873+0.26370798j],
        [ 0.13287019-0.28727943j, -0.93753362+0.14438406j]]),
 array([[ 0.35238021+0.j        ,  0.27432933+0.89474667j],
        [ 0.40306584+0.84461004j,  0.25956495-0.23832299j]]),
 array([[ 0.00155251+0.j        , -0.12760804+0.99182346j],
        [-0.67363556+0.73906206j,  0.00100456+0.00118369j]])]
array([[ 0.93581149+0.j        ,  0.30695499+0.17330751j],
        [-0.33416011+0.11222244j,  0.91897344+0.17672282j]]),
 array([[  9.99999985e-01 +0.00000000e+00j,
           1.01886858e-04 +1.37103870e-04j],
        [  8.55819920e-06 +1.70602345e-04j,
           7.71744547e-01 -6.35932642e-01j]])]

2. test 4 

initial = 

initial[0][0]= 3.
initial[1][0]= 1.5
initial/= np.linalg.norm(initial)

Phi[[ 8.58388478e-04+9.92190021e-05j]
 [ 0.00000000e+00+0.00000000e+00j]
 [ 1.80015601e-04+9.78874372e-06j]
 [-1.07120192e-03-7.96149663e-04j]
 [-7.07462218e-01+1.37615533e-04j]
 [-3.75191031e-03+9.87825784e-04j]
 [ 2.83010677e-03+3.17617559e-05j]
 [-7.06729452e-01+1.81449418e-03j]
 [ 3.73175204e-05-4.59819601e-04j]
 [ 7.48413243e-04+9.45691805e-04j]
 [ 0.00000000e+00+0.00000000e+00j]
 [ 1.69892156e-04-2.45655715e-04j]]

Phi_internal_reshaped[[ 1.80015601e-04 -7.07462218e-01  2.83010677e-03  3.73175204e-05]
 [-1.07120192e-03 -3.75191031e-03 -7.06729452e-01  7.48413243e-04]]
 
Phi_internal_reshaped(over sites {2,5} )
[ [ 0.0  -0.707  0.0    0.0 ]
  [ 0.00   0.0   -0.707  0.0 ] ]
  
NORM1.4142082194688053

z[ 5.33728072e-01  1.15646832e-01  3.05649489e+00  3.85216225e-01
  1.48569851e+00  1.74377054e+00 -1.90899834e-05  6.45615956e+00
 -1.11142006e-01  3.84841958e-01  9.31363603e+00  6.93910189e-01
  2.95361669e-01  2.00290719e+00  1.16681906e+00]
  
  3. test5
  
  initial = 

initial[0][0]= 1.
initial[1][0]= 0.
initial/= np.linalg.norm(initial)

Phi[[ 3.96573010e-04+0.00000000e+00j]
 [ 0.00000000e+00+0.00000000e+00j]
 [ 1.59727386e-02+2.89551504e-03j]
 [-1.08784648e-02-8.66502623e-04j]
 [-3.94808122e-01+4.85003290e-04j]
 [-5.86644824e-01+1.16351841e-04j]
 [ 5.86153991e-01-6.46411560e-05j]
 [-3.94524981e-01+4.65056125e-04j]
 [ 1.04016558e-02-1.78622106e-03j]
 [ 1.57482931e-02-2.27246017e-03j]
 [ 0.00000000e+00+0.00000000e+00j]
 [ 3.81954376e-04-3.46926338e-05j]]
 
 Phi_internal_reshaped[[ 0.01597274 -0.39480812  0.58615399  0.01040166]
 [-0.01087846 -0.58664482 -0.39452498  0.01574829]]
 
 z[5.16719233e-01 0.00000000e+00 3.07067118e+00 1.27151326e-01
 1.49987493e+00 1.66110710e+00 2.55905889e-03 6.37349642e+00
 7.19306793e-02 7.09249900e-01 9.49670885e+00 7.31540131e-01
 1.31883730e-03 2.04053705e+00 1.02530093e+00]
