Example 1

n=5 , sites k=6

Results

1. test3

initial = 

initial[0][0]= 1.
initial[1][0]= 1.5
initial/= np.linalg.norm(initial)

Phi[[-2.53787400e-04+0.00073287j]
 [ 0.00000000e+00+0.        j]
 [-1.99820395e-01-0.00035552j]
 [ 1.64592281e-04-0.0004793 j]
 [ 5.17225379e-01+0.00016506j]
 [ 1.30808461e-01-0.00078185j]
 [ 4.39979507e-01+0.00046699j]
 [-1.50021463e-01+0.00057014j]
 [-2.02253620e-03-0.00014818j]
 [ 6.77741808e-01-0.00076727j]
 [ 0.00000000e+00+0.        j]
 [-3.09588175e-03-0.00021878j]]
Phi_internal_reshaped[[-1.99820395e-01  5.17225379e-01  4.39979507e-01 -2.02253620e-03]
 [ 1.64592281e-04  1.30808461e-01 -1.50021463e-01  6.77741808e-01]]
NORM1.4142039948878378
l[ 0.70710699  0.70710657]

==> Phi_internal_reshaped (over sites {2,3,4,6} )
[ [-0.20  0.52  0.44  0.00 ]
  [ 0.00  0.13 -0.15  0.68 ] ]
  
  coin parameters (5 coins) --correct as well
z = [ 5.67245656e-01  8.62542665e-01  3.24500715e+00  
      1.14230303e-04   1.67421087e+00  2.14350919e+00  
      1.81753069e-01  6.85589784e+00   -1.18406431e-01  
      7.03375383e-01  9.30637140e+00  8.47415396e-01
      7.00791378e-01  2.15641254e+00  9.99177735e-01] 
      
      
#delete outer sites :
  coin parameters
array([  5.68522976e-01,   8.65712906e-01,   3.24550472e+00,      
        -2.51271256e-08,   1.67470846e+00,   2.14480399e+00,
         1.77182025e-01,   6.85719332e+00,  -1.19194522e-01,
         7.04930793e-01,   9.30558346e+00,   8.45526613e-01,
         7.09160290e-01,   2.15452369e+00,   9.99999630e-01])
  
  coin-operators
[array([[ 0.75400463+0.j        , -0.59927656+0.26896957j],
        [-0.47098956-0.45787101j, -0.70844625-0.25812185j]]),
 array([[  1.58515380e-04 +0.00000000e+00j,
           5.21717414e-01 -8.53118348e-01j],
        [  8.98298308e-01 +4.39386078e-01j,
          -1.33708708e-04 +8.51416878e-05j]]),
 array([[ 0.42092995+0.j        , -0.81732507+0.3934434j ],
        [ 0.84423616-0.331788j  ,  0.28621158-0.30865022j]])] 
        
 result from forward quantum walk with given coins : 
 array([[ -3.79213681e-06 +1.05579453e-05j],
       [  0.00000000e+00 +0.00000000e+00j],
       [ -1.98642075e-01 -4.44084964e-06j],
       [  2.42849514e-06 -6.76136273e-06j],
       [  5.21248004e-01 -4.33148440e-07j],
       [  1.27214819e-01 -6.93554472e-06j],
       [  4.34559705e-01 -1.77964580e-06j],
       [ -1.52545636e-01 +2.65038090e-07j],
       [ -2.92659117e-05 -2.15998360e-06j],
       [  6.78635339e-01 +1.22684700e-06j],
       [  0.00000000e+00 +0.00000000e+00j],
       [ -4.56990790e-05 -3.37278740e-06j]])
        
  
clarification : max.ent.state over sites {2,5} not sites {3,4} :

Phi_internal_internal =
array([[ 0.51992254,  0.43594997],
       [ 0.12784624, -0.15196018]])
       
lli = array([0.67850714, 0.1985861 ]) --> not maximally entnagled state.

code : 
Phi_internal_internal = np.delete(Phi_internal_reshaped,[0,3,4,7],None)
Phi_internal_internal= Phi_internal_internal.reshape(2,2)
psiAAi, lli, psiBBi = np.linalg.svd(Phi_internal_internal,full_matrices=1) #decomposition of initial matrix
print (lli)


2. test 4 

initial = 

initial[0][0]= 3.
initial[1][0]= 1.5
initial/= np.linalg.norm(initial)

Phi[[ 8.58388478e-04+9.92190021e-05j]
 [ 0.00000000e+00+0.00000000e+00j]
 [ 1.80015601e-04+9.78874372e-06j]
 [-1.07120192e-03-7.96149663e-04j]
 [-7.07462218e-01+1.37615533e-04j]
 [-3.75191031e-03+9.87825784e-04j]
 [ 2.83010677e-03+3.17617559e-05j]
 [-7.06729452e-01+1.81449418e-03j]
 [ 3.73175204e-05-4.59819601e-04j]
 [ 7.48413243e-04+9.45691805e-04j]
 [ 0.00000000e+00+0.00000000e+00j]
 [ 1.69892156e-04-2.45655715e-04j]]

Phi_internal_reshaped[[ 1.80015601e-04 -7.07462218e-01  2.83010677e-03  3.73175204e-05]
 [-1.07120192e-03 -3.75191031e-03 -7.06729452e-01  7.48413243e-04]]
 
Phi_internal_reshaped(over sites {2,5} )
[ [ 0.0  -0.707  0.0    0.0 ]
  [ 0.00   0.0   -0.707  0.0 ] ]
  
NORM1.4142082194688053

z[ 5.33728072e-01  1.15646832e-01  3.05649489e+00  3.85216225e-01
  1.48569851e+00  1.74377054e+00 -1.90899834e-05  6.45615956e+00
 -1.11142006e-01  3.84841958e-01  9.31363603e+00  6.93910189e-01
  2.95361669e-01  2.00290719e+00  1.16681906e+00]
  
  3. test5
  
  initial = 

initial[0][0]= 1.
initial[1][0]= 0.
initial/= np.linalg.norm(initial)

Phi[[ 3.96573010e-04+0.00000000e+00j]
 [ 0.00000000e+00+0.00000000e+00j]
 [ 1.59727386e-02+2.89551504e-03j]
 [-1.08784648e-02-8.66502623e-04j]
 [-3.94808122e-01+4.85003290e-04j]
 [-5.86644824e-01+1.16351841e-04j]
 [ 5.86153991e-01-6.46411560e-05j]
 [-3.94524981e-01+4.65056125e-04j]
 [ 1.04016558e-02-1.78622106e-03j]
 [ 1.57482931e-02-2.27246017e-03j]
 [ 0.00000000e+00+0.00000000e+00j]
 [ 3.81954376e-04-3.46926338e-05j]]
 
 Phi_internal_reshaped[[ 0.01597274 -0.39480812  0.58615399  0.01040166]
 [-0.01087846 -0.58664482 -0.39452498  0.01574829]]
 
 z[5.16719233e-01 0.00000000e+00 3.07067118e+00 1.27151326e-01
 1.49987493e+00 1.66110710e+00 2.55905889e-03 6.37349642e+00
 7.19306793e-02 7.09249900e-01 9.49670885e+00 7.31540131e-01
 1.31883730e-03 2.04053705e+00 1.02530093e+00]
